client
dev tun
proto {{ openvpn_protocol }}
remote {{ openvpn_server }} {{ openvpn_port }}
cipher {{ openvpn_cipher }}
auth {{ openvpn_auth_digest }}
resolv-retry infinite
nobind
persist-key
persist-tun
ns-cert-type server
comp-lzo
key-direction 1
verb 3
route {{ ansible_default_ipv4.address }} 255.255.255.255 net_gateway
{{ openvpn_tls_version_min }}
remote-cert-eku "TLS Web Server Authentication"

verify-x509-name 'C={{ openvpn_key_country }}, ST={{ openvpn_key_province }}, L={{ openvpn_key_city }}, O={{ openvpn_key_org }}, OU={{ openvpn_key_ou }}, CN=server' subject

# If you'd like to enable 2FA support, uncomment the following line
;auth-user-pass

<ca>
{{ openvpn_ca_contents.stdout }}
</ca>

<cert>
{{ item[1].stdout }}
</cert>

<key>
{{ item[2].stdout }}
</key>

<tls-auth>
{{ openvpn_hmac_firewall_contents.stdout }}
</tls-auth>
